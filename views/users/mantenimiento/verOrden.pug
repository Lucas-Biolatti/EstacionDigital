doctype html
html(lang="es")
    head
        meta(charset="UTF-8")
        meta(http-equiv="X-UA-Compatible", content="IE=edge")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        title Cierre de Orden de Trabajo | Polimetal
        link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous")
        script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous")
        link(href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet')
        script(src="https://unpkg.com/boxicons@2.0.9/dist/boxicons.js")
        link(href="https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css" rel="stylesheet")
        link(rel="stylesheet" href="/stylesheets/styleIndex.css")
        style.  
            h5{
                color:rgb(185, 21, 21);
            }
    body 
        .container     
            
                
            div(class="w-100")
                div(class="")
                    a(href="/") 
                        div(style="text-align: center;")
                            img(src="/images/logo.jpg" alt="logo" class="img-fluid")
                    a(href="mtto", style="display: inline")
                        h1(style="text-align:center") 
                            i(class='bx bx-arrow-back bx-tada bx-flip-vertical')
                    if result.length > 0        

                        h2(class="col-9 bg-dark bg-gradient text-white w-100")= "Descripcion de la Orden de trabajo NÂ°"+idOrden 
                        input(type="hidden", name="idOrden" value=idOrden id="idOrden")
                        
                        div(class="container")
                            br
                            div(class="row") 
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Detecto
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].detecto
                                
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Equipo
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].equipo
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Fecha
                                p(class="col-3 p-2 mb-2" id="detecto")= f
                                
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Turno
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].turno
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Parada de Proceso?
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].paradaProceso
                                
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Prioridad
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].prioridad
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Tipo de Parada?
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].tipoParada
                                
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Hora de Inicio
                                p(class="col-3 p-2 mb-2" id="detecto")= hi
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Hora de Finalizacion 
                                p(class="col-3 p-2 mb-2" id="detecto")= hf

                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Tiempo de Parada
                                p(class="col-3 p-2 mb-2" id="detecto")= total+" Minutos"
                                
                            
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Descripcion de la parada
                                p(class="col-9 p-2 mb-2" id="detecto")= result[0].descripcion
                        
                        h2(class="col-9 bg-dark bg-gradient text-white w-100") Descripcion de la Resolucion
                        div(class="p-2")
                        

                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Fecha
                                p(class="col-3 p-2 mb-2" id="detecto")= fecha_cierre 

                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Tiempo
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].tiempo
                                
                                
                            
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Descripcion de la Reparacion
                                p(class="col-9 p-2 mb-2" id="detecto")= result[0].descripcion_cierre
                                
                            .row 
                                h5(class="col-9 w-100" style="text-align:center;border-bottom:solid") Pendientes
                            div(class="row")
                            
                                    
                                    p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Tareas pendientes 
                                    p(class="col-3 p-2 mb-2" id="detecto")= result[0].pendiente
                                
                                    p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Observaciones 
                                    p(class="col-3 p-2 mb-2" id="detecto")= result[0].observaciones_cierre
                            
                            .row 
                                h5(class="col-9 w-100" style="text-align:center;border-bottom:solid") Responsables
                            .row
                                table(class="table" id="tableEjecutores") 
                                    thead 
                                        th ID 
                                        th LEGAJO 
                                        th NOMBRE 
                                        th CALORICAS
                                        th TRABAJO EN ALTURA
                                        
                                    tbody 

                                
                                    
                            
                            .row 
                                h5(class="col-9 w-100" style="text-align:center;border-bottom:solid") Estado
                            div(class="row")
                                    p(class="col-3 p-2 mb-2 bg-danger text-white text-aling-center bg-gradient") Estado
                                    p(class="col-3 p-2 mb-2" id="detecto")= result[0].estado
                            br

                            
                        
                    else
                        h1= "No se encontraron resultados"
                                
                                
                footer 
                        br 
                        div(class="col-12" style="text-align:center")
                            h6 &copy Copyright 2021 | Polimetal S.A            

        script. 
            document.addEventListener('DOMContentLoaded', (event) => {
                let idOrden = document.getElementById('idOrden').value;
                let tableEjecutores = document.getElementById('tableEjecutores');
                fetch(`/Mantenimiento/nominaOrden?idOrden=${idOrden}`)
                    .then(response => response.json())
                    .then(data => {
                        data.forEach(item => {
                            let row = tableEjecutores.insertRow();
                            
                            let cellId = row.insertCell(0);
                            let cellLegajo = row.insertCell(1);
                            let cellNombre = row.insertCell(2);
                            let cellCaloria = row.insertCell(3);
                            let cellAltura = row.insertCell(4);
                           

                            cellId.textContent = item.id;
                            cellLegajo.textContent = item.legajo;
                            cellNombre.textContent = item.nombre;
                            cellCaloria.textContent = item.calorias;
                            cellAltura.textContent = item.altura;
                            
                        }); 

                        
                            });
                        });
                

