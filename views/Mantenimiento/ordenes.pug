doctype html
html(lang="es")
    head
        meta(charset="UTF-8")
        meta(http-equiv="X-UA-Compatible", content="IE=edge")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        title Polimetal S.A | Ordenes de Trabajo
        
        link(href="https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css" rel="stylesheet")
        link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css")
        link(rel="stylesheet", href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap5.min.css")
        link(rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css")
        link(rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css")
        link(href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet')
        script(src="https://kit.fontawesome.com/d3705cd4bb.js" crossorigin="anonymous")
        link(rel="stylesheet" href="/stylesheets/styleIndex.css")

    body
        div(class="d-flex")
            div(id="sidebar-container" class="bg-primary")
                div(class="logo")
                img(src="/favicon.ico" alt="" class="d-inline-block")
                h4(class="text-light font-weight-bold d-inline-block") Polimetal S.A
                div(class="menu")
                    a(href="/" class="d-block text-light" )
                        i(class="icon ion-md-home m-2 lead") 
                            |
                            |Inicio
                    a(href="ordenTrabajo" class="d-block " id="selected")
                        i(class="icon ion-md-construct m-2 lead") 
                            |
                            |Ordenes de Trabajo
                    a(href="ordenesDia" class="d-block text-light")
                        i(class="icon ion-md-construct m-2 lead")   
                            |
                            |Ordenes del Dia
                        
                    a(href="#" class="d-block text-light")
                       
                    
                    
                    ul(class="logout")
                        li  
                            div(style="text-align: center")
                                img(src="../images/usuario.png", alt="" width="50px")
                            p(class="d-block p-3 text-light")= nombre
                            a(href="/logout" class="d-block p-3 text-light" )
                                i(class="icon ion-md-log-in m-2 lead" )="    Logout"
               
            
            div(class="w-100") 
                div(class="container" style="padding: 20px;")
                    button#menu-toggle.btn.btn-outline-primary â˜°
                    a(href="/") 
                        div(style="text-align: center;")
                            img(src="/images/logo.jpg" alt="logo" class="img-fluid")
                
                    div(style="text-align: center;")
                        h2 Ordenes por Sector
                    div(class="table-responsive")
                        table(class="table table-striped table-hover")
                            thead 
                                th Id 
                                th Sector 
                                th Mtto 
                                
                            tbody 
                                each i in sector
                                    tr 
                                        td= i.idSector
                                        td= i.Descripcion
                                        td 
                                            
                                            a(href="ordenXSector?id="+i.idSector+"&nombre="+i.Descripcion)
                                                button(class="btn btn-success") Ver Todas  
                                        
                            
                                    
                    br
                    hr
                    h2 Todas las Ordenes Pendientes
                
                table(id="t1" class="table table-hover" style="width:100%; " )
                    
                    


                    
                script(src="https://code.jquery.com/jquery-3.5.1.js")
                script(src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous")
                script(src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js")
                script(src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js")   
                script(src="https://kit.fontawesome.com/d3705cd4bb.js" crossorigin="anonymous")
                script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous")
                script(type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js")
                script(type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js")
                script(type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js")
                script(type="text/javascript" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js")
                script(type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js")
                script(type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.colVis.min.js")
                script(type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js")
                script(type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js")
                script(src="https://unpkg.com/boxicons@2.0.9/dist/boxicons.js")
                
                
                        
                script. 
                    document.addEventListener("DOMContentLoaded", function() {
                        const menuToggle = document.getElementById('menu-toggle');
                        const sidebarContainer = document.getElementById('sidebar-container');

                        menuToggle.addEventListener('click', function() {
                            sidebarContainer.classList.toggle('active');
                        });
                    }); 
                    fetch('/Mantenimiento/ordenes')
                        .then(response=>response.json())
                        .then(datos=>{
                            
                            let dataset=[];
                            for(let i=0;i<datos.length;i++){
                                if(datos[i].estado==="Pendiente"||datos[i].estado==="En Proceso"){
                                    var dat=[
                                datos[i].idOrden,
                                datos[i].sector,
                                datos[i].avisar,
                                datos[i].equipo,
                                datos[i].fecha,
                                datos[i].turno,
                                datos[i].descripcion,
                                `<td class="${datos[i].estado}">${datos[i].estado}</td>`,
                                datos[i].accion,
                                ]
                                dataset.push(dat);
                                }
                            
                            }
                            console.log(dataset);
                            $(document).ready(function () {
                            $('#t1').DataTable({
                                
                                dom: 'Bfrtlip',
                                buttons: [
                                    
                                {
                                    
                                    "extend":"excelHtml5",
                                    "text":'Excel',
                                    "textAttr":"Descargar Excel",
                                    "className":"btn btn-success",
                                    
                                },
                                {
                                    extend:'print',
                                    text:'Imprimir',
                                    textAttr:'Imprimir Reporte',
                                    className:'btn btn-info',
                                },
                                {
                                    extend:'pdfHtml5',
                                    text:'PDF',
                                    textAttr:'Guardar en PDF',
                                    className:'btn btn-danger'
                                }
                                    
                                    
                                ],
                                data:dataset,
                                columns:[
                                    {title:'Id'},
                                    {title:'Sector'},
                                    {title:'Avisar a'},
                                    {title:'Equipo'},
                                    {title:'fecha'},
                                    {title:'Turno'},
                                    {title:'Descripcion'},
                                    {title:'Estado'},
                                    {title:'Accion'},
                                ],
                        });
                    }); 
                        })