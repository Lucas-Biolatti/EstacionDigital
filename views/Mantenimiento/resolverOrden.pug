doctype html
html(lang="es")
    head
        meta(charset="UTF-8")
        meta(http-equiv="X-UA-Compatible", content="IE=edge")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        title Cierre de Orden de Trabajo | Polimetal
        link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous")
        script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous")
        link(href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet')
        script(src="https://unpkg.com/boxicons@2.0.9/dist/boxicons.js")
        link(href="https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css" rel="stylesheet")
        link(rel="stylesheet" href="/stylesheets/styleIndex.css")
        style.  
            h5{
                color:rgb(185, 21, 21);
            }
    body 
        div(class="d-flex")
            div(id="sidebar-container" class="bg-primary")
                div(class="logo")
                img(src="/favicon.ico" alt="" class="d-inline-block")
                h4(class="text-light font-weight-bold d-inline-block") Polimetal S.A
                div(class="menu")
                    a(href="/" class="d-block p-3 text-light" )
                        i(class="icon ion-md-home m-2 lead") 
                            |
                            |Inicio
                    a(href="ordenTrabajo" class="d-block p-3 " id="selected")
                        i(class="icon ion-md-construct m-2 lead") 
                            |
                            |Ordenes de Trabajo
                   
                    
                    
                    ul(class="logout")
                        li  
                            div(style="text-align: center")
                                img(src="/images/usuario.png", alt="" width="50px")
                            p(class="d-block p-3 text-light")= Nombre
                            a(href="/logout" class="d-block p-3 text-light" )
                                i(class="icon ion-md-log-in m-2 lead" )="    Logout"
               
            
            div(class="w-100")
                div(class="container")
                    a(href="/cierremtto") 
                        div(style="text-align: center;")
                            img(src="/images/logo.jpg" alt="logo" class="img-fluid")
                    if result.length > 0        

                        h2(class="bg-dark bg-gradient text-white")= "Descripcion de la Orden de trabajo NÂ°"+idOrden 
                        
                        div(class="container")
                            br
                            div(class="row") 
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Detecto
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].detecto
                                
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Equipo
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].equipo
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Fecha
                                p(class="col-3 p-2 mb-2" id="detecto")= f
                                
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Turno
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].turno
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Parada de Proceso?
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].paradaProceso
                                
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Prioridad
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].prioridad
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Tipo de Parada?
                                p(class="col-3 p-2 mb-2" id="detecto")= result[0].tipoParada
                                
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Hora de Inicio
                                p(class="col-3 p-2 mb-2" id="detecto")= hi
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Hora de Finalizacion 
                                p(class="col-3 p-2 mb-2" id="detecto")= hf

                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Tiempo de Parada
                                p(class="col-3 p-2 mb-2" id="detecto")= total+" Minutos"
                                
                            
                            div(class="row")
                                p(class="col-3 p-2 mb-2 bg-danger text-white bg-gradient") Descripcion de la parada
                                p(class="col-9 p-2 mb-2" id="detecto")= result[0].descripcion
                        hr
                    
                        hr
                        h2(class="bg-dark bg-gradient text-white") Descripcion de la Resolucion
                        br
                        form(action="resolverOrden", method="post")

                            div(class="row")
                                input(type="hidden", name="idOrden", value=idOrden)
                                div(class="col-md-3")
                                    label(for="fecha" class="form-label") Fecha
                                    input(type="date" class="form-control" id="fecha" name="fecha" required)
                                div(class="col-md-6")
                                    label(for="descripcion" class="form-label") Descripcion de la Reparacion
                                    input(type="text", name="descripcion" class="form-control" id="descripcion")
                                div(class="col-md-3")
                                    label(for="tiempo" class="form-label") Tiempo
                                    input(type="number", name="tiempo" class="form-control" id="tiempo")
                            br
                            h5
                                i(class='bx bxs-label bx-sm') Repuestos Utilizados
                            hr
                            div(class="row")
                                
                                div(class="col-md-2")
                                    label(for="c1" class="form-label") Codigo
                                    input(type="text", name="c1" class="form-control" id="c1")
                                div(class="col-md-8")
                                    label(for="rto1" class="form-label") Descripcion
                                    p(id="rto1" class="col-12 p-2 mb-2 bg-light bg-gradient")
                                div(class="col-md-2")
                                    label(for="cantidad1" class="form-label") Cantidad 
                                    input(type="number", name="cantidad1" id="cantidad1" class="form-control" value=0)
                            div(class="row")
                                
                                div(class="col-md-2")
                                    label(for="c2" class="form-label") Codigo
                                    input(type="text", name="c2" class="form-control" id="c2")
                                div(class="col-md-8")
                                    label(for="rto2" class="form-label") Descripcion
                                    p(id="rto2" class="col-12 p-2 mb-2 bg-light bg-gradient")
                                div(class="col-md-2")
                                    label(for="cantidad2" class="form-label") Cantidad 
                                    input(type="number", name="cantidad2" id="cantidad2" class="form-control" value=0)
                            div(class="row")
                                
                                div(class="col-md-2")
                                    label(for="c3" class="form-label") Codigo
                                    input(type="text", name="c3" class="form-control" id="c3")
                                div(class="col-md-8")
                                    label(for="rto3" class="form-label") Descripcion
                                    p(id="rto3" class="col-12 p-2 mb-2 bg-light bg-gradient")
                                div(class="col-md-2")
                                    label(for="cantidad3" class="form-label") Cantidad 
                                    input(type="number", name="cantidad3" id="cantidad3" class="form-control" value=0)
                            br
                            h5
                                i(class='bx bxs-label bx-sm') Tareas pendientes
                            hr
                            div(class="row")
                            
                                div(class="col-md-5")
                                    label(for="pendiente" class="form-label") Tareas pendientes 
                                    input(type="text", name="pendiente" class="form-control" id="pendiente")
                                div(class="col-md-5")
                                    label(for="observaciones" class="form-label") Observaciones 
                                    input(type="text", name="observaciones" id="observaciones" class="form-control")
                            br
                            h5 
                                i(class='bx bxs-label bx-sm') Responsables
                            hr
                            div(class="row")
                                
                                div(class="col-md-4")
                                    label(for="personas" class="form-label") Ejecutor 1
                                    input(type="text", name="ejecutor1" class="form-control" id="personas")
                        
                                
                                div(class="col-md-4")
                                    label(for="personas" class="form-label") Ejecutor 2
                                    input(type="text", name="ejecutor2" class="form-control" id="personas")
                        
                                
                                div(class="col-md-4")
                                    label(for="personas" class="form-label") Ejecutor 3
                                    input(type="text", name="ejecutor3" class="form-control" id="personas")
                            br
                            h5
                                i(class='bx bxs-label bx-sm') Estado 
                            hr        
                            div(class="row")
                                
                                div(class="col-md-4")
                                    label(for="observaciones" class="form-label") Estado
                                    select(name="estado" class="form-select")
                                        option Pendiente 
                                        option En Proceso 
                                        option Cerrado 
                            br

                            input(type="submit", value="Cerrar Orden" class="button btn-success")
                            input(type="reset", value="Limpiar", class="button btn-secondary")
                        
                    else
                        h1= "No se encontraron resultados"
                                
                                
                footer 
                        br 
                        div(class="col-12" style="text-align:center")
                            h6 &copy Copyright 2021 | Polimetal S.A            

        script. 
            let c1 = document.getElementById("c1");
            let c2 = document.getElementById("c2");
            let c3 = document.getElementById("c3");
            let d1 = document.getElementById("rto1");
            let d2 = document.getElementById("rto2");
            let d3 = document.getElementById("rto3");
            
            fetch("items")
                .then(resp=>resp.json())
                .then(data=>{
                    c1.addEventListener('change',(e)=>{
                        e.preventDefault();
                        let valor;
                        for(let i=0;i<data.length;i++){
                            if(data[i].Item === document.getElementById("c1").value){
                                d1.innerHTML = data[i].Descripcion;
                            }
                        }
                    })
                    c2.addEventListener('change',(e)=>{
                        e.preventDefault();
                        let valor;
                        for(let i=0;i<data.length;i++){
                            if(data[i].Item === document.getElementById("c2").value){
                                d2.innerHTML = data[i].Descripcion;
                                
                            }
                        }
                        
                    });
                    c3.addEventListener('change',(e)=>{
                        e.preventDefault();
                        let valor;
                        for(let i=0;i<data.length;i++){
                            if(data[i].Item === document.getElementById("c3").value){
                                d3.innerHTML = data[i].Descripcion;
                                
                            }
                        }
                        
                    });
                });
                

